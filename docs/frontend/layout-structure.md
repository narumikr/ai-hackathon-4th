# 全体レイアウト構造設計書

## 概要

歴史学習特化型旅行AIエージェントシステムの全体レイアウト構造設計。Next.js 16 App Routerを使用し、一貫性のあるユーザー体験を提供するための基本レイアウトを定義する。

## 関連ドキュメント

- [画面設計書](./screen-design.md) - 各画面の詳細設計
- [UIコンポーネント一覧](./ui-components.md) - 共通UIコンポーネントの詳細

## デザインシステム

### カラーパレット

プライマリカラー: `#ffc096` (Warm Peach) - 歴史的な温かみと親しみやすさを表現

```css
Primary: #ffc096
Neutral: #737373
Success: #22c55e
Warning: #f59e0b
Danger: #ef4444
Info: #3b82f6
```

### タイポグラフィ

- **フォントファミリー**: Inter, Hiragino Sans, Hiragino Kaku Gothic ProN, Noto Sans JP
- **見出し**: 太字、大きめのサイズで階層を明確に
- **本文**: 読みやすさを重視した行間とサイズ

## 全体レイアウト構造

### 1. 基本レイアウトパターン

アプリケーション全体で3つの主要なレイアウトパターンを使用：

#### A. メインレイアウト（Main Layout）
- **用途**: ほぼすべての画面で使用
- **構成**: ヘッダー + コンテンツエリア + フッター
- **特徴**: ナビゲーションとブランディングの一貫性

```
┌─────────────────────────────────────┐
│          Header (固定)               │
├─────────────────────────────────────┤
│                                     │
│                                     │
│         Content Area                │
│         (スクロール可能)              │
│                                     │
│                                     │
├─────────────────────────────────────┤
│          Footer                     │
└─────────────────────────────────────┘
```

#### B. フルスクリーンレイアウト（Fullscreen Layout）
- **用途**: 旅行ガイド表示、振り返りパンフレット表示
- **構成**: ヘッダー（最小化） + フルスクリーンコンテンツ
- **特徴**: コンテンツに集中できる没入型体験

```
┌─────────────────────────────────────┐
│    Header (最小化/透過)              │
├─────────────────────────────────────┤
│                                     │
│                                     │
│                                     │
│      Fullscreen Content             │
│                                     │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

#### C. モーダルレイアウト（Modal Layout）
- **用途**: 確認ダイアログ、画像プレビュー、詳細情報表示
- **構成**: オーバーレイ + モーダルコンテンツ
- **特徴**: 現在のコンテキストを保持しながら追加情報を表示

```
┌─────────────────────────────────────┐
│                                     │
│   ┌─────────────────────────┐      │
│   │                         │      │
│   │    Modal Content        │      │
│   │                         │      │
│   └─────────────────────────┘      │
│                                     │
│      (Background Overlay)           │
└─────────────────────────────────────┘
```

## コンポーネント詳細設計

### 1. Header（ヘッダー）

#### 構成要素

```
┌──────────────────────────────────────────────────────────┐
│  [Logo]  [Nav: ホーム | 旅行計画 | 振り返り]    [User]   │
└──────────────────────────────────────────────────────────┘
```

#### デスクトップ版（1024px以上）

- **高さ**: 64px
- **背景**: 白（`bg-white`）、下部にシャドウ
- **左側**: ロゴ + アプリ名
- **中央**: メインナビゲーション（水平メニュー）
- **右側**: ユーザーアイコン/メニュー

#### タブレット版（768px〜1023px）

- **高さ**: 64px
- **左側**: ロゴ
- **右側**: ハンバーガーメニュー

#### モバイル版（〜767px）

- **高さ**: 56px
- **左側**: ロゴ（簡略版）
- **右側**: ハンバーガーメニュー

#### ナビゲーション項目

1. **ホーム** (`/`)
   - システム概要とメイン機能への導線

2. **旅行計画** (`/travel`)
   - 旅行一覧
   - 新規作成ボタン（プライマリアクション）

3. **振り返り** (`/reflection`)
   - 完了済み旅行の振り返り一覧

#### 実装ファイル

- `components/layout/Header.tsx`
- `components/layout/Navigation.tsx`
- `components/layout/MobileMenu.tsx`

### 2. Footer（フッター）

#### 構成要素

```
┌──────────────────────────────────────────────────────────┐
│  [About] [Privacy] [Terms]        © 2026 Historical...   │
└──────────────────────────────────────────────────────────┘
```

#### デザイン

- **高さ**: 80px（デスクトップ）、自動（モバイル）
- **背景**: ニュートラルグレー（`bg-neutral-100`）
- **内容**:
  - 左側: リンク（About, Privacy Policy, Terms of Service）
  - 右側: コピーライト表記

#### 実装ファイル

- `components/layout/Footer.tsx`

### 3. Content Area（コンテンツエリア）

#### 共通仕様

- **最大幅**: 1280px（デスクトップ）
- **パディング**: 
  - デスクトップ: 32px（左右）
  - タブレット: 24px（左右）
  - モバイル: 16px（左右）
- **最小高さ**: `calc(100vh - header高さ - footer高さ)`

#### コンテナパターン

##### A. 標準コンテナ（Standard Container）
- **用途**: 一覧画面、フォーム画面
- **最大幅**: 1280px
- **中央寄せ**: `mx-auto`

##### B. ワイドコンテナ（Wide Container）
- **用途**: 旅行ガイド表示
- **最大幅**: 1536px
- **中央寄せ**: `mx-auto`

##### C. フルワイドコンテナ（Full-width Container）
- **用途**: ヒーローセクション、画像ギャラリー
- **最大幅**: 100%
- **パディングなし**

### 4. Sidebar（サイドバー）

一部の画面で使用する補助的なナビゲーション

#### 構成

```
┌────────┬──────────────────────────┐
│        │                          │
│ Side   │    Main Content          │
│ bar    │                          │
│        │                          │
└────────┴──────────────────────────┘
```

#### 仕様

- **幅**: 256px（デスクトップ）
- **背景**: 白（`bg-white`）
- **ボーダー**: 右側に薄いボーダー
- **レスポンシブ**: タブレット以下では非表示またはドロワー形式

#### 使用画面

- 旅行ガイド表示画面（目次として）
- 振り返り作成画面（進捗表示として）

## レスポンシブデザイン

### ブレークポイント

Tailwind CSS v4のデフォルトブレークポイントを使用：

```css
sm: 640px   /* スマートフォン（横向き）、小型タブレット */
md: 768px   /* タブレット */
lg: 1024px  /* ノートPC、小型デスクトップ */
xl: 1280px  /* デスクトップ */
2xl: 1536px /* 大型デスクトップ */
```

### デバイス別レイアウト戦略

#### モバイルファースト（〜767px）

- **ナビゲーション**: ハンバーガーメニュー
- **コンテンツ**: 単一カラム
- **フォント**: やや小さめ
- **タッチターゲット**: 最小44x44px

#### タブレット（768px〜1023px）

- **ナビゲーション**: ハンバーガーメニューまたは簡略版
- **コンテンツ**: 2カラム可能
- **フォント**: 標準サイズ

#### デスクトップ（1024px以上）

- **ナビゲーション**: フル表示
- **コンテンツ**: 2〜3カラム可能
- **フォント**: 標準〜大きめ
- **ホバーエフェクト**: 有効

## アクセシビリティ

### 基本方針

- **WCAG 2.1 AA準拠**を目指す
- **キーボードナビゲーション**完全対応
- **スクリーンリーダー**対応

### 具体的な実装

1. **セマンティックHTML**
   - `<header>`, `<nav>`, `<main>`, `<footer>`, `<article>`, `<section>`を適切に使用

2. **ARIA属性**
   - `aria-label`, `aria-labelledby`, `aria-describedby`を適切に設定
   - `role`属性で役割を明示

3. **フォーカス管理**
   - フォーカス可能な要素に明確なフォーカスインジケーター
   - タブオーダーの論理的な順序

4. **カラーコントラスト**
   - テキストと背景のコントラスト比 4.5:1以上（通常テキスト）
   - テキストと背景のコントラスト比 3:1以上（大きなテキスト）

## パフォーマンス最適化

### レイアウトシフト対策

- **ヘッダー**: 固定高さを設定
- **画像**: `width`と`height`属性を明示
- **フォント**: `font-display: swap`を使用

### レンダリング最適化

- **Server Components**: 可能な限りServer Componentsを使用
- **Client Components**: インタラクティブな部分のみ
- **Code Splitting**: ルートベースの自動分割

## 実装ファイル構成

```
frontend/src/
├── app/
│   ├── layout.tsx                    # ルートレイアウト（全画面共通）
│   └── (main)/                       # メインレイアウトグループ
│       ├── layout.tsx                # メインレイアウト
│       ├── page.tsx                  # ホーム画面
│       ├── travel/
│       │   ├── layout.tsx            # 旅行セクションレイアウト
│       │   └── ...
│       └── reflection/
│           ├── layout.tsx            # 振り返りセクションレイアウト
│           └── ...
├── components/
│   ├── layout/
│   │   ├── Header.tsx                # ヘッダーコンポーネント
│   │   ├── Footer.tsx                # フッターコンポーネント
│   │   ├── Navigation.tsx            # ナビゲーションコンポーネント
│   │   ├── MobileMenu.tsx            # モバイルメニュー
│   │   ├── Sidebar.tsx               # サイドバーコンポーネント
│   │   ├── Container.tsx             # コンテナコンポーネント
│   │   └── index.ts                  # エクスポート
│   └── ui/
│       └── ...
└── styles/
    └── globals.css                   # グローバルスタイル
```

## 実装優先度

### Phase 1（MVP必須）

1. ルートレイアウト（`app/layout.tsx`）
2. ヘッダーコンポーネント（基本版）
3. フッターコンポーネント（基本版）
4. コンテナコンポーネント
5. モバイルメニュー

### Phase 2（機能充実）

1. ナビゲーションコンポーネント（完全版）
2. サイドバーコンポーネント
3. レスポンシブ対応の強化
4. アクセシビリティの改善

### Phase 3（UX向上）

1. アニメーション効果
2. ローディング状態の改善
3. エラー状態の改善
4. パフォーマンス最適化

## 次のステップ

この全体レイアウト構造設計に基づいて、以下を進めます：

1. **各画面の詳細レイアウト設計**
   - ホーム画面
   - 旅行一覧画面
   - 旅行作成画面
   - 旅行ガイド表示画面
   - 振り返り一覧画面
   - 写真アップロード・振り返り作成画面

2. **レイアウトコンポーネントの実装**
   - Header, Footer, Navigation, Container等

3. **レスポンシブデザインの詳細化**
   - 各ブレークポイントでの具体的な挙動

4. **アクセシビリティテスト**
   - キーボードナビゲーション
   - スクリーンリーダー対応
