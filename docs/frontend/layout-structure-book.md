# ブックスタイルレイアウト構造設計書（Book-Style Layout）

## 概要

歴史学習特化型旅行AIエージェントシステムのブックスタイルレイアウト設計。本や教科書のような体験を提供し、ページをめくる感覚で歴史を学ぶインターフェース。

## デザインコンセプト

### キーワード

- **本の体験**: 物理的な本を読む感覚
- **ページめくり**: スクロールではなくページ遷移
- **目次**: 章立てされた構造
- **教科書**: 学習に最適化されたレイアウト

### インスピレーション

- **物理的な本**: 見開き、ページめくり、しおり
- **電子書籍リーダー**: Kindle, Apple Books
- **教科書**: 章立て、図版、コラム
- **美術書**: 大きな画像、余白の美

## 全体レイアウト構造

### 1. 本棚（Bookshelf）- ホーム画面

トップページは本棚のような目次デザイン。各旅行が「本」として表示される。

```
┌─────────────────────────────────────────────────────────┐
│  Historical Travel Agent                                │
│  あなたの歴史旅行ライブラリ                              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  │
│  │         │  │         │  │         │  │         │  │
│  │  京都    │  │  奈良    │  │  鎌倉    │  │  広島    │  │
│  │  の旅    │  │  の旅    │  │  の旅    │  │  の旅    │  │
│  │         │  │         │  │         │  │         │  │
│  │ 2026.2  │  │ 2026.3  │  │ 2026.4  │  │ 2026.5  │  │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  │
│                                                         │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐               │
│  │         │  │         │  │  [+]    │               │
│  │  東京    │  │  大阪    │  │  新しい │               │
│  │  の旅    │  │  の旅    │  │  旅行   │               │
│  │         │  │         │  │         │               │
│  │ 2025.12 │  │ 2026.1  │  │         │               │
│  └─────────┘  └─────────┘  └─────────┘               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 本のカードデザイン

- **サイズ**: 縦長（本の形）
- **表紙**: タイトル、日付、サムネイル画像
- **背表紙**: 横から見た時の表示
- **ホバー効果**: 本が少し浮き上がる
- **クリック**: 本が開くアニメーション → 目次ページへ


### 2. 目次ページ（Table of Contents）

本を開くと最初に表示される目次。章立てされた構造。

```
┌──────────────────────────────────────────────────────────┐
│                                                          │
│                    京都の歴史旅行                         │
│                   2026年2月15日〜17日                     │
│                                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                          │
│  目次                                                     │
│                                                          │
│  第1章  旅の概要 ............................ 1          │
│  第2章  歴史年表 ............................ 5          │
│  第3章  観光スポット                                      │
│         3.1 清水寺 .......................... 12         │
│         3.2 金閣寺 .......................... 18         │
│         3.3 伏見稲荷大社 .................... 24         │
│  第4章  歴史的背景 .......................... 30         │
│  第5章  チェックポイント .................... 36         │
│                                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                          │
│  [✕ 閉じる]                          [→ 第1章へ]        │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

#### 目次の特徴

- **章番号**: 明確な階層構造
- **ページ番号**: 各章の開始ページ
- **クリック**: 該当ページへジャンプ
- **しおり**: 前回読んだページを記憶

### 3. 見開きページ（Spread Pages）

本文は見開き（2ページ）で表示。デスクトップでは左右2ページ、モバイルでは1ページ。

```
[デスクトップ - 見開き表示]
┌─────────────────────┬─────────────────────┐
│                     │                     │
│  [左ページ]          │  [右ページ]          │
│                     │                     │
│  12                 │                 13  │
│                     │                     │
│  清水寺              │  [大きな写真]        │
│                     │                     │
│  778年に創建された   │                     │
│  歴史ある寺院...     │                     │
│                     │                     │
│  [図版]              │  [キャプション]      │
│                     │                     │
│                     │                     │
│  ← 前へ    目次    次へ →                 │
└─────────────────────┴─────────────────────┘

[モバイル - 単ページ表示]
┌─────────────────────┐
│                     │
│  [ページ]            │
│                     │
│  12                 │
│                     │
│  清水寺              │
│                     │
│  778年に創建された   │
│  歴史ある寺院...     │
│                     │
│  [図版]              │
│                     │
│                     │
│  ← 前へ  目次  次へ →│
└─────────────────────┘
```

#### ページの構成要素

- **ページ番号**: 下部中央または外側
- **ヘッダー**: 章タイトル（上部）
- **本文**: 読みやすいタイポグラフィ
- **図版**: 大きく配置
- **余白**: たっぷりとした余白

### 4. ページめくりアニメーション

物理的な本のページをめくる感覚を再現。

```
[ページめくり - 3Dアニメーション]

Step 1: 現在のページ
┌─────────────────────┐
│                     │
│  Page 12            │
│                     │
└─────────────────────┘

Step 2: めくり始め（右から左へ）
┌─────────────────────┐
│         ╱           │
│  Page  ╱  Page 13   │
│   12  ╱             │
└─────────────────────┘

Step 3: めくり中
┌─────────────────────┐
│    │                │
│ P  │   Page 13      │
│ 12 │                │
└─────────────────────┘

Step 4: めくり完了
┌─────────────────────┐
│                     │
│  Page 13            │
│                     │
└─────────────────────┘
```

#### アニメーションの種類

1. **3Dページめくり** (推奨)
   - CSS 3D Transform
   - リアルな影と曲線
   - 滑らかな動き

2. **スライドページめくり** (シンプル)
   - 横スライド
   - フェード効果
   - 軽量

3. **カールページめくり** (高度)
   - ページの角が巻き上がる
   - マウス追従
   - 重い処理

### 5. ナビゲーション

本のような直感的なナビゲーション。

```
┌──────────────────────────────────────────────────────────┐
│  [☰ 目次]  [🔖 しおり]  [🖨️ 印刷]  [✕ 閉じる]           │
├──────────────────────────────────────────────────────────┤
│                                                          │
│                    [ページ内容]                           │
│                                                          │
├──────────────────────────────────────────────────────────┤
│  [← 前のページ]  [12/42]  [次のページ →]                 │
└──────────────────────────────────────────────────────────┘
```

#### ナビゲーション要素

- **目次ボタン**: 目次ページへ戻る
- **しおりボタン**: 現在のページをブックマーク
- **印刷ボタン**: PDF出力
- **閉じるボタン**: 本棚へ戻る
- **ページ送り**: 前後のページへ移動
- **ページインジケーター**: 現在位置表示

#### キーボードショートカット

- **→ / Space**: 次のページ
- **← / Shift+Space**: 前のページ
- **Home**: 最初のページ
- **End**: 最後のページ
- **Esc**: 本棚へ戻る

### 6. しおり機能（Bookmark）

読書の進捗を管理。

```
┌──────────────────────────────────────────────────────────┐
│  しおり                                                   │
├──────────────────────────────────────────────────────────┤
│  📖 京都の歴史旅行                                        │
│     └─ 第3章 清水寺 (12ページ)                           │
│        最終閲覧: 2026年2月10日                            │
│                                                          │
│  📖 奈良の歴史旅行                                        │
│     └─ 第2章 歴史年表 (8ページ)                          │
│        最終閲覧: 2026年2月8日                             │
└──────────────────────────────────────────────────────────┘
```

## ページレイアウトパターン

### パターン1: テキスト中心ページ

```
┌─────────────────────┐
│  第1章 旅の概要      │
│  ─────────────────  │
│                     │
│  京都は794年に平安   │
│  京として創建され、  │
│  1000年以上にわたり │
│  日本の都として栄え │
│  ました。           │
│                     │
│  この旅行では、京都  │
│  の主要な歴史的スポ  │
│  ットを巡ります。    │
│                     │
│                     │
│                  1  │
└─────────────────────┘
```

### パターン2: 画像中心ページ

```
┌─────────────────────┐
│                     │
│  [大きな画像]        │
│                     │
│                     │
│                     │
│  清水寺の本堂        │
│  (国宝指定)          │
│                     │
│                     │
│                  2  │
└─────────────────────┘
```

### パターン3: 見開き画像

```
┌─────────────────────┬─────────────────────┐
│                     │                     │
│                                           │
│        [見開きの大きな画像]                │
│                                           │
│                     │                     │
│                     │                     │
│  京都の街並みパノラマ                      │
│                     │                     │
│                  2  │                 3   │
└─────────────────────┴─────────────────────┘
```

### パターン4: 年表ページ

```
┌─────────────────────┐
│  第2章 歴史年表      │
│  ─────────────────  │
│                     │
│  794年               │
│  ├─ 平安京遷都       │
│  │                  │
│  1467年              │
│  ├─ 応仁の乱         │
│  │                  │
│  1868年              │
│  ├─ 明治維新         │
│  │                  │
│  1945年              │
│  └─ 終戦             │
│                     │
│                  5  │
└─────────────────────┘
```

### パターン5: コラムページ

```
┌─────────────────────┐
│  ┌───────────────┐  │
│  │ コラム         │  │
│  │ ─────────────│  │
│  │               │  │
│  │ 清水の舞台から │  │
│  │ 飛び降りる     │  │
│  │               │  │
│  │ この言葉の由来 │  │
│  │ は...         │  │
│  │               │  │
│  └───────────────┘  │
│                     │
│                  6  │
└─────────────────────┘
```

## タイポグラフィ

### フォント設定

```css
/* 見出し */
h1 { 
  font-size: 2.5rem; 
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: 1.5rem;
}

/* 本文 */
body {
  font-size: 1.125rem;  /* 18px - 読みやすいサイズ */
  line-height: 1.8;     /* ゆったりとした行間 */
  font-family: "Noto Serif JP", serif;  /* 明朝体 */
}

/* ページ番号 */
.page-number {
  font-size: 0.875rem;
  color: #666;
}
```

### 文字組み

- **行長**: 最大35〜40文字（読みやすさ）
- **段落間**: 1.5〜2行分の余白
- **インデント**: 1文字分

## カラースキーム

### ページカラー

```css
/* 紙の色 */
--page-bg: #faf8f5;        /* クリーム色 */
--page-text: #2d2d2d;      /* ダークグレー */

/* アクセント */
--accent: #8b4513;         /* 茶色（本の装丁） */
--accent-light: #d2691e;   /* ライトブラウン */

/* 影 */
--shadow: rgba(0,0,0,0.1);
```

### ダークモード

```css
/* ダークモード */
--page-bg-dark: #1a1a1a;
--page-text-dark: #e0e0e0;
```

## インタラクション設計

### ページめくり操作

1. **クリック/タップ**
   - 右側クリック: 次のページ
   - 左側クリック: 前のページ

2. **スワイプ**
   - 左スワイプ: 次のページ
   - 右スワイプ: 前のページ

3. **キーボード**
   - 矢印キー、スペースキー

4. **ボタン**
   - 前へ/次へボタン

### ページめくり速度

```typescript
const PAGE_TURN_DURATION = {
  fast: 300,    // クリック時
  normal: 500,  // スワイプ時
  slow: 800,    // 自動再生時
};
```

## レスポンシブ対応

### デスクトップ（1024px以上）

- **見開き表示**: 左右2ページ
- **ページサイズ**: 各ページ 600px幅
- **余白**: 左右に十分な余白

### タブレット（768px〜1023px）

- **単ページ表示**: 1ページのみ
- **ページサイズ**: 画面幅の80%
- **余白**: 左右に適度な余白

### モバイル（〜767px）

- **単ページ表示**: 1ページのみ
- **ページサイズ**: 画面幅の95%
- **余白**: 最小限

## 実装技術

### ページめくりライブラリ

1. **turn.js** (推奨)
   - jQuery依存
   - リアルな3Dページめくり
   - タッチ対応

2. **react-pageflip**
   - React専用
   - 軽量
   - カスタマイズ可能

3. **CSS 3D Transform** (自作)
   - ライブラリ不要
   - 完全制御
   - 実装コスト高

### コード例

```tsx
import HTMLFlipBook from 'react-pageflip';

<HTMLFlipBook
  width={600}
  height={800}
  size="stretch"
  minWidth={315}
  maxWidth={1000}
  minHeight={400}
  maxHeight={1533}
  maxShadowOpacity={0.5}
  showCover={true}
  mobileScrollSupport={true}
>
  <div className="page">Page 1</div>
  <div className="page">Page 2</div>
  <div className="page">Page 3</div>
</HTMLFlipBook>
```

## パフォーマンス最適化

### ページプリロード

```typescript
// 前後2ページをプリロード
const preloadPages = (currentPage: number) => {
  const pagesToLoad = [
    currentPage - 2,
    currentPage - 1,
    currentPage + 1,
    currentPage + 2,
  ].filter(p => p >= 0 && p < totalPages);
  
  pagesToLoad.forEach(loadPage);
};
```

### 画像最適化

- **遅延ローディング**: 表示されるページのみ
- **レスポンシブ画像**: デバイスに応じたサイズ
- **WebP形式**: 軽量化

## 実装ファイル構成

```
frontend/src/
├── app/
│   └── (book)/
│       ├── layout.tsx              # ブックレイアウト
│       ├── page.tsx                # 本棚（ホーム）
│       └── travel/
│           └── [id]/
│               ├── page.tsx        # 目次ページ
│               └── read/
│                   └── page.tsx    # 読書ページ
├── components/
│   ├── book/
│   │   ├── Bookshelf.tsx           # 本棚
│   │   ├── BookCover.tsx           # 本の表紙
│   │   ├── TableOfContents.tsx     # 目次
│   │   ├── FlipBook.tsx            # ページめくり
│   │   ├── Page.tsx                # ページコンポーネント
│   │   ├── PageNavigation.tsx      # ページナビゲーション
│   │   └── Bookmark.tsx            # しおり
│   └── ui/
│       └── ...
└── hooks/
    ├── usePageFlip.ts              # ページめくりフック
    └── useBookmark.ts              # しおり管理フック
```

## 実装優先度

### Phase 1（基本機能）

1. 本棚レイアウト
2. 目次ページ
3. 単ページ表示
4. シンプルなページ送り

### Phase 2（ページめくり）

1. 3Dページめくりアニメーション
2. 見開き表示（デスクトップ）
3. スワイプ対応
4. キーボードショートカット

### Phase 3（機能拡張）

1. しおり機能
2. 印刷/PDF出力
3. ダークモード
4. 読書進捗管理

## 利点と課題

### 利点

- **直感的**: 本を読む感覚
- **没入感**: 学習に集中できる
- **ユニーク**: 差別化要素
- **教育的**: 教科書のような体験

### 課題

- **実装コスト**: アニメーション実装が複雑
- **パフォーマンス**: 3Dアニメーションは重い
- **アクセシビリティ**: スクリーンリーダー対応が難しい
- **SEO**: 単一ページアプリになりがち

### 解決策

- **段階的実装**: Phase 1から順次
- **フォールバック**: シンプル版も用意
- **ARIA対応**: セマンティックHTML
- **SSR**: Next.jsで対応

## 次のステップ

1. **プロトタイプ作成**: Figmaでモックアップ
2. **ライブラリ選定**: turn.js vs react-pageflip
3. **パフォーマンステスト**: 実機でテスト
4. **ユーザーテスト**: 実際の使用感を確認
