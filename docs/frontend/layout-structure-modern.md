# モダンレイアウト構造設計書（Alternative Design）

## 概要

歴史学習特化型旅行AIエージェントシステムのモダン・インタラクティブレイアウト設計。Apple、Airbnb、Notionなどの最新UIトレンドを取り入れ、没入感のある体験を提供する。

## デザインコンセプト

### キーワード

- **ストーリーテリング**: 歴史を物語として体験
- **没入感**: コンテンツに集中できる環境
- **インタラクティブ**: スクロールやジェスチャーで発見する楽しさ
- **ミニマル**: 余白を活かした洗練されたデザイン

### インスピレーション

- **Apple**: スクロール連動アニメーション、紙芝居的な展開
- **Airbnb**: カード型レイアウト、スムーズなトランジション
- **Notion**: サイドバーレス、フォーカスモード
- **Medium**: 読書体験に最適化されたタイポグラフィ

## 全体レイアウト構造

### 1. フローティングナビゲーション（Floating Navigation）

従来の固定ヘッダーではなく、コンテキストに応じて表示/非表示が切り替わるフローティングナビゲーション。

```
┌─────────────────────────────────────┐
│  ◯ ◯ ◯  [Logo]         [Menu] 👤   │ ← 透過背景、スクロールで表示/非表示
├─────────────────────────────────────┤
│                                     │
│         Full Content Area           │
│                                     │
└─────────────────────────────────────┘
```

#### 特徴

- **スクロールアップ**: ナビゲーション表示
- **スクロールダウン**: ナビゲーション非表示（コンテンツに集中）
- **トップ位置**: 透過背景
- **スクロール後**: 白背景 + シャドウ
- **高さ**: 56px（コンパクト）

#### 実装技術

- Framer Motion（アニメーション）
- Intersection Observer API（スクロール検知）
- CSS `backdrop-filter: blur()`（ガラスモーフィズム）

### 2. ヒーローセクション（Hero Section）

各画面のトップに配置する、視覚的インパクトのある導入部。

```
┌─────────────────────────────────────┐
│                                     │
│         [大きな見出し]               │
│         [サブテキスト]               │
│                                     │
│         [CTA Button]                │
│                                     │
│    ↓ スクロールヒント                │
└─────────────────────────────────────┘
```

#### バリエーション

##### A. フルスクリーンヒーロー（ホーム画面）
- **高さ**: 100vh
- **背景**: グラデーション + パララックス効果
- **アニメーション**: フェードイン + スライドアップ

##### B. ミディアムヒーロー（一覧画面）
- **高さ**: 60vh
- **背景**: 単色 or 画像
- **アニメーション**: シンプルなフェードイン

##### C. コンパクトヒーロー（詳細画面）
- **高さ**: 40vh
- **背景**: グラデーション
- **アニメーション**: なし（高速表示優先）

### 3. 横スクロールセクション（Horizontal Scroll Section）

旅行ガイドや年表を横スクロールで表示する、モダンなレイアウト。

```
┌─────────────────────────────────────────────────────────────┐
│  [Section Title]                                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐          │
│  │ Card 1 │  │ Card 2 │  │ Card 3 │  │ Card 4 │  →       │
│  └────────┘  └────────┘  └────────┘  └────────┘          │
│                                                             │
│  ○ ○ ○ ○ ○  (Progress Indicator)                          │
└─────────────────────────────────────────────────────────────┘
```

#### 使用場面

1. **旅行一覧画面**: 旅行カードを横スクロール
2. **年表表示**: 時系列を左から右へ
3. **観光スポット**: スポットカードを横スクロール
4. **写真ギャラリー**: 旅行写真を横スクロール

#### 実装技術

- CSS Scroll Snap（スムーズなスナップ）
- Intersection Observer（カード表示検知）
- タッチジェスチャー対応

#### コード例

```tsx
<div className="overflow-x-auto snap-x snap-mandatory">
  <div className="flex gap-6 px-6">
    {items.map((item) => (
      <div className="snap-center shrink-0 w-80">
        <Card {...item} />
      </div>
    ))}
  </div>
</div>
```

### 4. スクロール連動アニメーション（Scroll-Linked Animation）

Appleスタイルの紙芝居的な展開。スクロール位置に応じてコンテンツが変化。

```
[Scroll Position: 0%]
┌─────────────────────────────────────┐
│                                     │
│         [Image: 透明度 0%]           │
│         [Text: 透明度 100%]          │
│                                     │
└─────────────────────────────────────┘

[Scroll Position: 50%]
┌─────────────────────────────────────┐
│                                     │
│         [Image: 透明度 50%]          │
│         [Text: 透明度 50%]           │
│                                     │
└─────────────────────────────────────┘

[Scroll Position: 100%]
┌─────────────────────────────────────┐
│                                     │
│         [Image: 透明度 100%]         │
│         [Text: 透明度 0%]            │
│                                     │
└─────────────────────────────────────┘
```

#### アニメーションパターン

1. **パララックス**: 背景と前景が異なる速度でスクロール
2. **フェード**: スクロールに応じて透明度変化
3. **スケール**: スクロールに応じて拡大/縮小
4. **スライド**: 横からスライドイン
5. **スティッキー**: 特定位置で固定表示

#### 使用場面

- **ホーム画面**: システム紹介を紙芝居的に展開
- **旅行ガイド**: 歴史的背景を段階的に表示
- **振り返りパンフレット**: 旅行体験をストーリーとして展開

#### 実装技術

- Framer Motion（`useScroll`, `useTransform`）
- GSAP ScrollTrigger（高度なアニメーション）
- CSS `position: sticky`（スティッキー要素）

### 5. カードベースレイアウト（Card-Based Layout）

Airbnbスタイルのカード型レイアウト。ホバー/タップで拡大、クリックで詳細表示。

```
┌─────────────────────────────────────┐
│  ┌──────────┐  ┌──────────┐        │
│  │          │  │          │        │
│  │  Card 1  │  │  Card 2  │        │
│  │          │  │          │        │
│  └──────────┘  └──────────┘        │
│                                     │
│  ┌──────────┐  ┌──────────┐        │
│  │          │  │          │        │
│  │  Card 3  │  │  Card 4  │        │
│  │          │  │          │        │
│  └──────────┘  └──────────┘        │
└─────────────────────────────────────┘
```

#### カードデザイン

- **シャドウ**: 浮遊感のある柔らかいシャドウ
- **ボーダー**: なし or 極薄
- **角丸**: 16px（大きめ）
- **ホバー効果**: 
  - シャドウ強化
  - 軽い上昇（`translateY(-4px)`）
  - スケール拡大（`scale(1.02)`）

#### レスポンシブグリッド

```css
/* デスクトップ: 3カラム */
grid-template-columns: repeat(3, 1fr);

/* タブレット: 2カラム */
@media (max-width: 1024px) {
  grid-template-columns: repeat(2, 1fr);
}

/* モバイル: 1カラム */
@media (max-width: 768px) {
  grid-template-columns: 1fr;
}
```

### 6. サイドバーレス設計（Sidebarless Design）

Notionスタイルのサイドバーレス設計。必要に応じてスライドイン。

```
[通常状態]
┌─────────────────────────────────────┐
│                                     │
│         Full Width Content          │
│                                     │
└─────────────────────────────────────┘

[サイドバー表示時]
┌────────┬────────────────────────────┐
│        │                            │
│ Side   │    Content (縮小)          │
│ bar    │                            │
│        │                            │
└────────┴────────────────────────────┘
```

#### 特徴

- **デフォルト**: サイドバー非表示
- **トリガー**: ボタンクリック or ショートカット（`Cmd+\`）
- **アニメーション**: スムーズなスライドイン/アウト
- **オーバーレイ**: モバイルではオーバーレイ表示

#### 使用場面

- **旅行ガイド**: 目次をサイドバーに
- **振り返り作成**: 進捗状況をサイドバーに

### 7. フルスクリーンモード（Fullscreen Mode）

コンテンツに完全に集中できるフルスクリーンモード。

```
[通常モード]
┌─────────────────────────────────────┐
│  [Header]                           │
├─────────────────────────────────────┤
│         Content                     │
└─────────────────────────────────────┘

[フルスクリーンモード]
┌─────────────────────────────────────┐
│                                     │
│                                     │
│         Content Only                │
│                                     │
│                                     │
│  [✕] (Exit Button)                  │
└─────────────────────────────────────┘
```

#### 特徴

- **トリガー**: ボタンクリック or ショートカット（`F11`）
- **UI**: 最小限（終了ボタンのみ）
- **背景**: 黒 or ダークグレー
- **コンテンツ**: 中央配置、最大幅制限

#### 使用場面

- **旅行ガイド閲覧**: 印刷前のプレビュー
- **振り返りパンフレット**: 完成品の閲覧

## 画面別レイアウト詳細

### 1. ホーム画面（Modern Hero + Scroll Story）

```
┌─────────────────────────────────────┐
│  [Floating Nav - 透過]              │
├─────────────────────────────────────┤
│                                     │
│    Historical Travel Agent          │
│    歴史を旅する、新しい体験          │
│                                     │
│    [旅行を始める] [詳しく見る]       │
│                                     │
│    ↓                                │
└─────────────────────────────────────┘
        ↓ スクロール
┌─────────────────────────────────────┐
│  [Section 1: 事前学習]              │
│  [Image + Text - パララックス]       │
└─────────────────────────────────────┘
        ↓ スクロール
┌─────────────────────────────────────┐
│  [Section 2: 旅行体験]              │
│  [Image + Text - フェードイン]       │
└─────────────────────────────────────┘
        ↓ スクロール
┌─────────────────────────────────────┐
│  [Section 3: 振り返り]              │
│  [Image + Text - スライドイン]       │
└─────────────────────────────────────┘
        ↓ スクロール
┌─────────────────────────────────────┐
│  [CTA Section]                      │
│  [今すぐ始める]                      │
└─────────────────────────────────────┘
```

#### 実装ポイント

- **ヒーロー**: 100vh、グラデーション背景
- **各セクション**: 80vh、スクロール連動アニメーション
- **CTA**: 固定背景、パララックス効果

### 2. 旅行一覧画面（Horizontal Scroll Cards）

```
┌─────────────────────────────────────┐
│  [Floating Nav]                     │
├─────────────────────────────────────┤
│  あなたの旅行                        │
│  [+ 新しい旅行]                      │
├─────────────────────────────────────┤
│  進行中の旅行                        │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐      │
│  │京都│ │奈良│ │鎌倉│ │広島│  →  │
│  └────┘ └────┘ └────┘ └────┘      │
│  ○ ○ ○ ○                           │
├─────────────────────────────────────┤
│  完了した旅行                        │
│  ┌────┐ ┌────┐ ┌────┐             │
│  │東京│ │大阪│ │福岡│         →  │
│  └────┘ └────┘ └────┘             │
│  ○ ○ ○                             │
└─────────────────────────────────────┘
```

#### 実装ポイント

- **カード**: 320px幅、横スクロール
- **スナップ**: CSS Scroll Snap
- **アニメーション**: カード出現時にフェードイン

### 3. 旅行ガイド表示画面（Immersive Reading）

```
┌─────────────────────────────────────┐
│  [Floating Nav - 最小化]            │
│  [☰] [目次] [印刷] [フルスクリーン]  │
├─────────────────────────────────────┤
│                                     │
│         京都の歴史旅行               │
│         2026年2月15日〜17日          │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  [Hero Image - 大きく表示]   │   │
│  └─────────────────────────────┘   │
│                                     │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                     │
│  歴史年表                            │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐     │
│  │794 │ │1467│ │1868│ │1945│  →  │
│  └────┘ └────┘ └────┘ └────┘     │
│                                     │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                     │
│  観光スポット                        │
│  [カード型レイアウト]                │
│                                     │
└─────────────────────────────────────┘
```

#### 実装ポイント

- **タイポグラフィ**: 大きめ、読みやすい行間
- **余白**: たっぷりとした余白
- **年表**: 横スクロール、スティッキーヘッダー
- **スポット**: カード型、ホバー効果

### 4. 写真アップロード画面（Drag & Drop Gallery）

```
┌─────────────────────────────────────┐
│  [Floating Nav]                     │
├─────────────────────────────────────┤
│  京都旅行の振り返り                  │
│  写真をアップロードしてください       │
├─────────────────────────────────────┤
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  │   📷 ドラッグ&ドロップ       │   │
│  │   または クリックして選択    │   │
│  │                             │   │
│  └─────────────────────────────┘   │
├─────────────────────────────────────┤
│  アップロード済み (3枚)              │
│  ┌────┐ ┌────┐ ┌────┐             │
│  │ 📷 │ │ 📷 │ │ 📷 │             │
│  │ ✕  │ │ ✕  │ │ ✕  │             │
│  └────┘ └────┘ └────┘             │
│                                     │
│  [パンフレットを生成]                │
└─────────────────────────────────────┘
```

#### 実装ポイント

- **ドロップゾーン**: 大きく、視覚的にわかりやすい
- **プレビュー**: グリッドレイアウト、ホバーで拡大
- **アニメーション**: アップロード時にフェードイン

## インタラクション設計

### 1. マイクロインタラクション

細かな動きでUXを向上させる。

#### ボタン

```tsx
// ホバー時
transform: scale(1.05);
box-shadow: 0 8px 16px rgba(0,0,0,0.1);

// クリック時
transform: scale(0.95);

// ローディング時
<Spinner /> + 透明度50%
```

#### カード

```tsx
// ホバー時
transform: translateY(-4px);
box-shadow: 0 12px 24px rgba(0,0,0,0.15);

// クリック時
transform: scale(0.98);
```

### 2. ページトランジション

画面遷移時のアニメーション。

```tsx
// フェードイン
opacity: 0 → 1
duration: 300ms

// スライドイン
transform: translateY(20px) → translateY(0)
opacity: 0 → 1
duration: 400ms

// スケールイン
transform: scale(0.95) → scale(1)
opacity: 0 → 1
duration: 350ms
```

### 3. ローディング状態

```tsx
// スケルトンスクリーン
<div className="animate-pulse bg-gray-200 rounded" />

// プログレスバー
<div className="h-1 bg-primary-500 transition-all" style={{ width: `${progress}%` }} />

// スピナー
<LoadingSpinner size="lg" />
```

## 実装技術スタック

### アニメーションライブラリ

1. **Framer Motion** (推奨)
   - React専用、宣言的API
   - スクロール連動アニメーション
   - ジェスチャー対応

```tsx
import { motion } from 'framer-motion';

<motion.div
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ duration: 0.5 }}
>
  Content
</motion.div>
```

2. **GSAP** (高度なアニメーション)
   - ScrollTrigger（スクロール連動）
   - タイムライン制御
   - パフォーマンス最適化

### スクロール制御

1. **CSS Scroll Snap**
   - ネイティブ、パフォーマンス良好
   - 横スクロールに最適

```css
.scroll-container {
  scroll-snap-type: x mandatory;
  overflow-x: auto;
}

.scroll-item {
  scroll-snap-align: center;
}
```

2. **Intersection Observer API**
   - 要素の表示検知
   - 遅延ローディング
   - アニメーショントリガー

### レスポンシブ対応

```tsx
// Tailwind CSS
<div className="
  grid 
  grid-cols-1 
  md:grid-cols-2 
  lg:grid-cols-3 
  gap-6
">
```

## パフォーマンス最適化

### 1. 画像最適化

- **Next.js Image**: 自動最適化、遅延ローディング
- **WebP形式**: 軽量化
- **レスポンシブ画像**: デバイスに応じたサイズ

```tsx
<Image
  src="/hero.jpg"
  alt="Hero"
  width={1920}
  height={1080}
  priority // Above the fold
  placeholder="blur"
/>
```

### 2. アニメーション最適化

- **GPU加速**: `transform`, `opacity`のみ使用
- **will-change**: 事前にブラウザに通知
- **Intersection Observer**: 画面外の要素はアニメーション停止

```css
.animated-element {
  will-change: transform, opacity;
  transform: translateZ(0); /* GPU加速 */
}
```

### 3. コード分割

- **Dynamic Import**: 必要な時だけロード
- **Route-based Splitting**: ルート単位で分割

```tsx
const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <LoadingSpinner />,
});
```

## 実装ファイル構成

```
frontend/src/
├── app/
│   ├── layout.tsx                    # ルートレイアウト
│   └── (modern)/                     # モダンレイアウトグループ
│       ├── layout.tsx                # モダンレイアウト
│       ├── page.tsx                  # ホーム（スクロールストーリー）
│       ├── travel/
│       │   ├── page.tsx              # 旅行一覧（横スクロール）
│       │   └── [id]/
│       │       └── page.tsx          # 旅行ガイド（没入型）
│       └── reflection/
│           └── [id]/
│               └── page.tsx          # 写真アップロード
├── components/
│   ├── layout/
│   │   ├── FloatingNav.tsx           # フローティングナビゲーション
│   │   ├── HeroSection.tsx           # ヒーローセクション
│   │   ├── HorizontalScroll.tsx      # 横スクロールコンテナ
│   │   └── FullscreenMode.tsx        # フルスクリーンモード
│   ├── animations/
│   │   ├── ScrollReveal.tsx          # スクロール連動アニメーション
│   │   ├── ParallaxSection.tsx       # パララックス効果
│   │   └── PageTransition.tsx        # ページトランジション
│   └── ui/
│       ├── Card.tsx                  # モダンカード
│       ├── Button.tsx                # アニメーション付きボタン
│       └── ...
├── hooks/
│   ├── useScrollAnimation.ts         # スクロールアニメーションフック
│   ├── useIntersectionObserver.ts    # Intersection Observer フック
│   └── useMediaQuery.ts              # レスポンシブフック
└── styles/
    └── animations.css                # カスタムアニメーション
```

## 実装優先度

### Phase 1（コアエクスペリエンス）

1. フローティングナビゲーション
2. ヒーローセクション（ホーム画面）
3. 横スクロールセクション（旅行一覧）
4. カードコンポーネント

### Phase 2（インタラクション強化）

1. スクロール連動アニメーション
2. ページトランジション
3. マイクロインタラクション
4. フルスクリーンモード

### Phase 3（UX向上）

1. パララックス効果
2. サイドバーレス設計
3. ジェスチャー対応
4. パフォーマンス最適化

## 比較: 標準 vs モダン

| 項目 | 標準レイアウト | モダンレイアウト |
|------|---------------|-----------------|
| ナビゲーション | 固定ヘッダー | フローティング |
| スクロール | 縦のみ | 縦 + 横 |
| アニメーション | 最小限 | リッチ |
| カード | 静的 | インタラクティブ |
| 没入感 | 中 | 高 |
| 実装難易度 | 低 | 中〜高 |
| パフォーマンス | 高 | 中（最適化必要） |
| 開発時間 | 短 | 長 |

## 推奨事項

### 採用を推奨する場面

- **ターゲットユーザー**: 若年層、デジタルネイティブ
- **デバイス**: モダンブラウザ、高性能デバイス
- **コンテンツ**: ビジュアル重視、ストーリー性
- **ブランド**: 革新的、モダン

### 標準レイアウトを推奨する場面

- **ターゲットユーザー**: 幅広い年齢層
- **デバイス**: 低性能デバイスも含む
- **コンテンツ**: テキスト重視、情報密度高
- **開発期間**: 短期間

## 次のステップ

1. **プロトタイプ作成**: Figmaでモックアップ
2. **ユーザーテスト**: 実際のユーザーでテスト
3. **パフォーマンステスト**: Lighthouse等で計測
4. **段階的実装**: Phase 1から順次実装
