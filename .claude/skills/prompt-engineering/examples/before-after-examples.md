# 改善前後の比較例

このファイルでは、実際のプロンプト改善例を紹介する。

## 例1: データ分析タスク

### Before (曖昧)

```
このCSVファイルを分析してください。
```

### After (明確)

```
以下のCSVファイルを分析し、以下の形式で出力してください:

1. 基本統計
   - 各カラムの平均値、中央値、標準偏差
   - 欠損値の数と割合

2. 異常値の検出
   - 平均±2標準偏差を超える値をリストアップ
   - 各異常値が発生した行番号を記載

3. 相関分析
   - 数値カラム間の相関係数を計算
   - 相関係数が0.7以上または-0.7以下のペアを強調

出力形式: Markdown形式で表を使用
```

### 改善ポイント

- 具体的なアクション（基本統計、異常値検出、相関分析）を指定
- 期待する出力形式を明示
- 判断基準を明確化（平均±2標準偏差、相関係数の閾値）

## 例2: コードレビュー

### Before (一般的)

```
このPythonコードをレビューしてください。

[コード]
```

### After (構造化)

```
以下のPythonコードを、セキュリティとパフォーマンスの観点からレビューしてください。

<code>
[コード]
</code>

<review_criteria>
1. セキュリティ
   - SQLインジェクション
   - XSS脆弱性
   - 適切な入力検証

2. パフォーマンス
   - N+1クエリ問題
   - 不要なループ
   - データ構造の効率性

3. ベストプラクティス
   - PEP 8準拠
   - 適切なエラーハンドリング
   - 型ヒントの使用
</review_criteria>

各問題について:
- 行番号
- 重要度（high/medium/low）
- 問題の説明
- 具体的な改善案

をJSON形式で出力してください。
```

### 改善ポイント

- ロール設定不要でも観点を明示
- XMLタグで構造化
- 出力形式を具体的に指定
- レビュー基準を詳細化

## 例3: テキスト分類

### Before (例なし)

```
以下のテキストを分類してください:
"配送は早かったけど、商品に傷がありました。"
```

### After (Few-shot)

```
以下の形式でカスタマーレビューを分類してください:

例1:
入力: "この製品は素晴らしい!期待以上でした。"
出力: {"sentiment": "positive", "aspects": {"product": "positive"}}

例2:
入力: "普通です。特に良くも悪くもない。"
出力: {"sentiment": "neutral", "aspects": {}}

例3:
入力: "最悪です。二度と買いません。"
出力: {"sentiment": "negative", "aspects": {"overall": "negative"}}

例4:
入力: "価格は高いけど、品質は良いです。"
出力: {"sentiment": "mixed", "aspects": {"price": "negative", "quality": "positive"}}

実際のタスク:
入力: "配送は早かったけど、商品に傷がありました。"
出力:
```

### 改善ポイント

- 複数の例を提供（Few-shot learning）
- 多様なケースをカバー（positive、negative、neutral、mixed）
- JSONフォーマットで構造化された出力
- aspectsフィールドで詳細な分析を促す

## 例4: 問題解決

### Before (思考プロセスなし)

```
以下のビジネス問題を解決してください:
売上が前年比20%減少しています。
```

### After (Chain of Thought)

```
以下のビジネス問題を、段階的に分析して解決策を提案してください:

<problem>
売上が前年比20%減少しています。
</problem>

以下のステップで分析してください:

1. 状況の理解
   - 売上減少の時期とトレンド
   - 影響を受けている製品/サービス
   - 市場全体の状況

2. 原因の特定
   - 内部要因（価格、品質、マーケティングなど）
   - 外部要因（競合、経済状況、規制など）
   - データから読み取れる主要な原因

3. 解決策の立案
   - 短期的な対策（1-3ヶ月）
   - 中期的な対策（3-12ヶ月）
   - 長期的な戦略（1年以上）

4. 優先順位付け
   - ROI
   - 実現可能性
   - リスク

5. 推奨案
   - 最も効果的な3つの施策
   - 実装ステップ
   - 期待される成果

各ステップの思考プロセスを示してから、最終的な推奨案を提示してください。
```

### 改善ポイント

- XMLタグで問題を明確化
- Chain of Thoughtで段階的な分析を促す
- 各ステップで考慮すべき要素を明示
- 最終的な推奨案の形式を指定

## 例5: 文書作成

### Before (制約なし)

```
APIドキュメントを作成してください。
```

### After (詳細な指示)

```
あなたはAPI設計とテクニカルライティングの専門家です。
以下のRESTful APIのドキュメントを作成してください。

<api_spec>
エンドポイント: POST /api/users
機能: 新しいユーザーを作成
パラメータ: name, email, password
</api_spec>

以下のセクションを含めてください:

1. エンドポイント概要
   - HTTPメソッドとURL
   - 簡潔な機能説明

2. リクエスト仕様
   - ヘッダー
   - ボディパラメータ（型、必須/任意、説明）
   - リクエスト例（JSON）

3. レスポンス仕様
   - 成功時（200）のレスポンス例
   - エラー時（400、401、500など）のレスポンス例
   - 各フィールドの説明

4. 使用例
   - curlコマンドの例
   - JavaScriptでの呼び出し例

5. 注意事項
   - セキュリティ考慮事項
   - レート制限
   - 認証要件

Markdown形式で、開発者が理解しやすいように記述してください。
```

### 改善ポイント

- ロール設定で専門性を付与
- XMLタグで入力を構造化
- 必要なセクションを明示
- 各セクションの内容を詳細化
- 出力形式（Markdown）を指定

## 例6: 長文コンテキスト

### Before (構造なし)

```
以下の3つのドキュメントを比較してください:
[ドキュメント1]
[ドキュメント2]
[ドキュメント3]
```

### After (構造化)

```
以下の3つの提案書を比較し、最適な選択肢を推奨してください。

<document_1>
  <title>提案A: クラウド移行</title>
  <content>...</content>
</document_1>

<document_2>
  <title>提案B: オンプレミス強化</title>
  <content>...</content>
</document_2>

<document_3>
  <title>提案C: ハイブリッド構成</title>
  <content>...</content>
</document_3>

<comparison_criteria>
1. コスト（初期投資と運用コスト）
2. スケーラビリティ
3. セキュリティ
4. 実装期間
5. 保守性
</comparison_criteria>

比較結果を以下の形式で出力してください:

1. 各提案の要約（3-5文）
2. 比較表（各基準での評価: excellent/good/fair/poor）
3. 推奨案とその理由（200文字以内）

<comparison></comparison>タグ内に出力してください。
```

### 改善ポイント

- XMLタグで各ドキュメントを明確に区別
- 比較基準を明示
- 出力形式を具体的に指定（要約、比較表、推奨案）
- 出力タグを指定してフォーマットを制御

## まとめ

これらの例から学べる共通の改善パターン:

1. **明確な指示**: 曖昧さを排除し、具体的なアクションを指定
2. **構造化**: XMLタグや番号付きリストで情報を整理
3. **例示**: Few-shot learningで期待する出力を示す
4. **段階的思考**: Chain of Thoughtで推論プロセスを促す
5. **出力形式の明示**: JSON、Markdown、表などの形式を指定
6. **評価基準の明確化**: 判断が必要な場合は基準を提供
